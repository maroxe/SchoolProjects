%%% Preamble
\documentclass[paper=a4, fontsize=11pt]{scrartcl}
\usepackage[utf8]{inputenc}  
\usepackage[T1]{fontenc}
\usepackage{fourier}
\usepackage[english]{babel}															% English language/hyphenation
\usepackage[protrusion=true,expansion=true]{microtype}	
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage[pdftex]{graphicx}	
\usepackage{url}

%%% Custom sectioning
\usepackage{sectsty}
\allsectionsfont{\centering \normalfont\scshape}

%%% Custom headers/footers (fancyhdr package)
\usepackage{fancyhdr}
\pagestyle{fancyplain}
\fancyhead{}											% No page header
\fancyfoot[L]{}											% Empty 
\fancyfoot[C]{}											% Empty
\fancyfoot[R]{\thepage}									% Pagenumbering
\renewcommand{\headrulewidth}{0pt}			% Remove header underlines
\renewcommand{\footrulewidth}{0pt}				% Remove footer underlines
\setlength{\headheight}{13.6pt}


%%% Equation and float numbering
\numberwithin{equation}{section}		% Equationnumbering: section.eq#
\numberwithin{figure}{section}			% Figurenumbering: section.fig#
\numberwithin{table}{section}				% Tablenumbering: section.tab#


%%% Maketitle metadata
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} 	% Horizontal rule

\title{
		%\vspace{-1in} 	
		\usefont{OT1}{bch}{b}{n}
		\normalfont \normalsize \textsc{Ecole Polytechnique} \\ [25pt]
		\horrule{0.5pt} \\[0.4cm]
		\huge Modèles des Taux d'interêt \\
		\horrule{2pt} \\[0.5cm]
}
\author{
		\normalfont \normalsize
                Bachir EL KHADIR\\[-3pt] \normalsize
                \today	
}
\date{}

\newtheorem{theorem}{Theorem}

\newcommand{\IMG}[3]{
\includegraphics[scale=#3]{#1}%
}


%%% Begin document
\begin{document}
\maketitle

\newpage
\tableofcontents

\newpage
\input{merci.tex}
\newpage
\input{intro.tex} 
\newpage

La notion de taux d'interêt nous est familière et fait parti de notre vie de tous les jours.

Zéro Coupon

\section{Quelques définitions}
\begin{theorem}
$Z(t, T, S)$ est le montant qu'il faut investir dans un instrument risque-neutre au temps $T$ pour obtenir 1euro au temps S.
\end{theorem}
\begin{theorem}
$r$ le taux d'intêret instantné est défini comme étant
\end{theorem}
\begin{theorem}
La courbe de rendement ou la yield curve $L(t, T)$
\end{theorem}
\begin{theorem}
Le taux d'interet cumulé
\end{theorem}

\newpage
\section{Produits financier d'interêts}
Swap:
Un swap est un contract entre deux parties qui s'engagent à échanger des flux financier pendant une durée et à une fréquence détérminées. la plupart du temps, ces flux sont détérminé comme étant l'intêret sur un notionnel K. 
$$ N \sum D_t^{T_i} \tau_i (L(T_{i-1}) - K) $$

Caps/floor:
Un cap/floor peut être vu comme un call/put européenne sur un swap
$$ N \sum D_t^{T_i} \tau_i (L(T_{i-1}) - K)^+ $$

Swaption
$$ N (\sum D_t^{T_i} \tau_i (L(T_{i-1}) - K))^+ $$

\newpage
\section{Les différents modèles des taux d'interêts}

Certains produits financiers dépendent en grande partie de la courbe de rendement. Nous avons vu précédemment que la donnée du taux instantané $r_t$ permet de caractériser complètement cette courbe.

Il est donc important que la dynamque de $r_t$ soit à la fois riche pour pouvoir décrire la courbe de rendement observée dans le marché, et suffisemment simple pour que le temps nécessaire pour le calcul ne soit trop long.

Nous pouvons considérer que la courbe de rendement varie dans un espace vectoriel de dimension infinie. Toute tentative de la caracteriser par un nombre fini de paramètre rééls est donc vouée à l'échec.

Le modèle de Hull White a été introduit en 1990.  Un des atouts majeure de ce modèle est la possiblité de simuler la dynamique de $r_t$ par un arbre trinomiale. Ceci étant essentiel pour pricer des produits du type bermuda options
$$ \mathrm{d}r_t =  (\theta(t) - \alpha(t) r_t) \mathrm{d}t + \sigma(t) \mathrm{d} W_t$$
$$ r_t = e^{-\alpha t} r_0 + integral ...$$


\newpage
\section{Le modèle à deux facteurs}
\subsection{Motivation}



Montrons dans un premier temps pourquoi un modèle à un seul facteur n'est pas suffisant pour pricer certains produits disponible sur les marchés. En effet, considérons un produit $E$ dont le payoff  dépent  du spread entre un taux d'intêret cumulé entre $0$ et $T_1$ pour le premier et $0$ et $T_2$ pour le second.

La dynamique de $r_t$ dans le modèle de Vasicek est donné par

$$r_t = k(\theta - r_t)  \mathrm{d}t  + \sigma \mathrm{d}W_t$$
La formule analytique du bond zéro coupon est donc
$$P(t, T) = A(t, T) exp(-B(t, T) r_t)$$
En particulier le taux d'intêret cumulé est une donné par une transformation affine du taux instantané:
$$R(t, T) = \frac{ln P(t, T)}{T-t} =: a(t, T) + b(t, T) r_t$$
Le payoff du produit $E$ est donc fonction de la distribution jointe de $R(0, T_1)$ et $R(0, T_2)$. Sauf que:
$$Cor(R(0, T_1), R(0, T_2) = 1$$
On en déduit qu'un choc à $r_t$ agit de la même manière sur toutes les courbes
On observe sur les marchés que les taux à différentes maturités ne sont pas corrélés. Si on regarde le taux 2Y et 10Y

<Courbe 10Y> 

<Courbe 2Y>

Clairement un tel modèle ne capture pas ce comportement.

Dans cette section nous considérons un modèle où le taux d'intêret instantanté est donné par une somme de deux facteurs gaussiens centrés et corrélés. Pour fitter la yield courbe, on rajoute une fonction détérministe.

\begin{align*}
  \rm{d}X &= \\
  \rm{d}Y &= \\
  \rm{d} r &= X + Y + \phi(t)
\end{align*}

$$P(t, T) = E[...]$$

Le processus est markovien

Les cap floors ademettent une formule analytiques, comme pour les options vanilles : formule de blackscholes
Dans la pratique, les banques tradent beaucoup des produits exotiques. Ce n'est pas le cas pour ces produits => arbre de pricing

\subsection{Approximation de la solution par un arbre binomial}

Cette méthode a été d'abord suggéré par Hull-White (1994)
On commence par donner une approximation de la dynamique processus $x$ et $y$ :

$$E(x(t+\Delta t) | F_t) = x(t) e^{-a \Delta t}$$
$$V(x(t+\Delta t) | F_t) = \frac{\sigma^2}{2a} (1 - e^{-2a \Delta t})$$
$$Cov\{x(t+\Delta t), y(t+\Delta t) | F_t \} = \frac{\sigma \nu \rho}{a + b} (1-e^{-(a+b)\Delta t})$$

Dans l'abre, on commence par discrétiser le temps par un pas fixe $\Delta t$, ensuite à chaque pas de temps on fait l'approximation du couple aléatoire à cdf continue $(x, y)$ par un couple de variables de bernouilli qui a les même moments de premier et second ordre.

Le nombre de noeuds augmente de façon exponentielle en fonction du nombre de pas de temps. En pratique ceci est problématique et conduit vite à une saturation de mémoire. Pour palier à ce problème on  réutilise les noeuds


\IMG{img/slice.png}{Slice}{0.5}

Cependant, on ne peut ajouter un drift au noeud avec cette methode.

Paragraphe sur la taille des slice, ellipsoid
<example de Slice>


\begin{itemize}
\item Discrétisation
\item Construction de l'abre
\end{itemize}

\subsection{Formule analytique - Intégration}
Closed form des zero coupons

en pratique, gain en temps \\
< cachegrind results > \\

gain en precision \\
<Comparaison de slice entre cf et bf>


Amerlioration:
\begin{itemize}
\item Time dependant parameters
\end{itemize}

\subsection{Performance}
L'arbre est long mais beaucoup plus puissant
Imperfections de l'arbre:
\begin{itemize}
\item  bornee
\item  discretisation
\item  probabilite negative
\end{itemize}
Monte Carlo
Limitation
Closed Form

Le temps d'execution:
Arbre
Closed form

\newpage
\section{Application: calibration et pricing}
Le modèle à 2F permet de caputrer le hump de la courbe de rendement
Le nombre de paramètre est fini (5) => pas de overfitting


\subsection{Calibration}
Dans cette section on verra a quel point le modele peut fitter la realite.

\begin{itemize}
\item $h(t)$ pour reconstruire la yield curve $\sigma \rho \nu$ pour
\item  matcher la surface
\end{itemize}

\subsubsection{Calibration du drift}

$\Pi_j$ state price (arrow debrew) (paye 1 si le noeud $(t_n, j)$ est atteint.

$$D_j(h_n) := \frac{1}{1 + r(t_n)(t_{n+1} - t_n)} $$ Le discount factor
$$ \Pi_j(t_{n+1}) = \sum_j \Pi_j(t_n) p_{j, j'}(t_n) D_{j'}(h_n)$$
$$ \sum \Pi_j D_j(h_n) = P(0, t_{n+1}) $$

Developement de taylor => trouver $h_n$


\subsubsection{Methode de calibration de la surface - Méthode d'optimisation}

On calibre les caplets

Les caplets ne sont pas directement disponilbe sur les marche
On calibre les swaptions

Le probleme de calbration est un probleme d'optimisation
Courbe de vol implicite :
minimisation de l'erreur L2

\IMG{img/capsurf.png}{Cap surface}{0.5}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
