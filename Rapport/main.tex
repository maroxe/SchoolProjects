%%% Preamble
\documentclass[paper=a4, fontsize=11pt]{scrartcl}
\usepackage[utf8]{inputenc}  
\usepackage[T1]{fontenc}
\usepackage{fourier}
\usepackage[english]{babel}															% English language/hyphenation
\usepackage[protrusion=true,expansion=true]{microtype}	
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage[pdftex]{graphicx}	
\usepackage{url}
\usepackage{tikz}

%%% Custom sectioning
\usepackage{sectsty}
\allsectionsfont{\centering \normalfont\scshape}

%%% Custom headers/footers (fancyhdr package)
\usepackage{fancyhdr}
\pagestyle{fancyplain}
\fancyhead{}											% No page header
\fancyfoot[L]{}											% Empty 
\fancyfoot[C]{}											% Empty
\fancyfoot[R]{\thepage}									% Pagenumbering
\renewcommand{\headrulewidth}{0pt}			% Remove header underlines
\renewcommand{\footrulewidth}{0pt}				% Remove footer underlines
\setlength{\headheight}{13.6pt}


%%% Equation and float numbering
\numberwithin{equation}{section}		% Equationnumbering: section.eq#
\numberwithin{figure}{section}			% Figurenumbering: section.fig#
\numberwithin{table}{section}				% Tablenumbering: section.tab#


%%% Maketitle metadata
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} 	% Horizontal rule
\newcommand{\espr}[1]{
  \mathrm{E}^Q \left[ #1 \right]
}


\title{
		%\vspace{-1in} 	
		\usefont{OT1}{bch}{b}{n}
		\normalfont \normalsize \textsc{Ecole Polytechnique} \\ [25pt]
		\horrule{0.5pt} \\[0.4cm]
		\huge Modèles des Taux d'interêt \\
		\horrule{2pt} \\[0.5cm]
}
\author{
		\normalfont \normalsize
                Bachir EL KHADIR\\[-3pt] \normalsize
                \today	
}
\date{}

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{defn}{Definition}

\newcommand{\IMG}[3]{
  \begin{center}
    \includegraphics[scale=#3]{#1}%
    \end{center}
}


%%% Begin document
\begin{document}
\maketitle

\newpage
\tableofcontents

\newpage
\input{merci.tex}
\newpage
\input{intro.tex} 
\newpage
\input{partie1.tex} 
\newpage
\section{Les différents modèles des taux d'interêts}

Nous avons vu dans la partie précédente que pour calculer l'espérance, il faut donner la dynamique du produit sous-jacent.
Plusieurs choix sont disponilbes:
\begin{itemize}
\item Long term interest rate
\item Short term
\end{itemize}

Certains produits financiers dépendent directement la courbe de rendement. Nous avons vu précédemment que la donnée du taux instantané $r_t$ permet de caractériser complètement cette courbe. 

Il est donc important que la dynamque de $r_t$ soit à la fois riche pour pouvoir décrire la courbe de rendement observée dans le marché, et suffisemment simple pour que le temps nécessaire pour le calcul ne soit trop long.

Nous pouvons considérer que la courbe de rendement varie dans un espace vectoriel de dimension infinie. Toute tentative de la caracteriser par un nombre fini de paramètre rééls est donc vouée à l'échec.

Le modèle de Hull White a été introduit en 1990.  Un des atouts majeure de ce modèle est la possiblité de simuler la dynamique de $r_t$ par un arbre trinomiale. Ceci étant essentiel pour pricer des produits du type bermuda options
$$ \mathrm{d}r_t =  (\theta(t) - \alpha(t) r_t) \mathrm{d}t + \sigma(t) \mathrm{d} W_t$$
$$ r_t = e^{-\alpha t} r_0 + integral ...$$


\newpage
\section{Le modèle à deux facteurs}
\subsection{Motivation}


Considérons un produit $E$ dont le payoff  dépent  du spread entre un taux d'intêret cumulé entre $0$ et $T_1$ pour le premier et $0$ et $T_2$ pour le second. $E$ dépend donc de la distribution jointe des deux taux.

\subsubsection*{Limite des modèle à un seul facteur}
Montrons dans un premier temps pourquoi un modèle à un seul facteur n'est pas suffisant pour pricer ces produits qui dépendent non seulement de la distribution de chaque courbe de taux, mais aussi de leur corrélation. 

La dynamique de $r_t$ dans le modèle de Vasicek est donné par
$$r_t = k(\theta - r_t)  \mathrm{d}t  + \sigma \mathrm{d}W_t$$
La formule analytique du bond zéro coupon est donc
$$P(t, T) = A(t, T) exp(-B(t, T) r_t)$$
En particulier le taux d'intêret cumulé est une donné par une transformation affine du taux instantané:
$$R(t, T) = \frac{ln P(t, T)}{T-t} =: a(t, T) + b(t, T) r_t$$
Le payoff du produit $E$ est donc fonction de la distribution jointe de $R(0, T_1)$ et $R(0, T_2)$. Sauf que:
$$Cor(R(0, T_1), R(0, T_2) = 1$$

On en déduit qu'un choc à $r_t$ agit de la même manière sur toutes les courbes.

Dans la réalité, on observe sur les marchés que les taux à différentes maturités ne sont pas corrélés. Si on regarde le taux 2Y et 10Y

\IMG{img/libor.png}{Libor}{1}

Un modèle à un seul facteur ne capture pas ce comportement. Essayons de pallier à ce problème en rajoutons un facteur à ce modèle.

Dans cette section nous considérons un modèle où le taux d'intêret instantanté est donné par une somme de deux facteurs gaussiens centrés et corrélés. 
\begin{align*}
  \rm{d}X &= \\
  \rm{d}Y &= \\
  \rm{d} r &= X + Y + \phi(t)
\end{align*}

Pour fitter la courbe on rajoute une fonction détérministe.


$$P(t, T) = E[...]$$

Le processus est markovien

Les cap floors ademettent une formule analytiques, comme pour les options vanilles : formule de blackscholes
Dans la pratique, les banques tradent beaucoup des produits exotiques. Ce n'est pas le cas pour ces produits => arbre de pricing

\newpage
\subsection{Approximation de la solution par un arbre binomial}

Cette méthode a été d'abord suggéré par Hull-White (1994)
On commence par donner une approximation de la dynamique processus $x$ et $y$, par une suite de variable de discretisé $((\widetilde{x}_i, \widetilde{y}_i) \approx (x(i \Delta i), (y(i \Delta t))_i $. Pour celà nous calculerons les deux premier moment de $(x, y)$

$$E(x(t+\Delta t) | F_t) = x(t) e^{-a \Delta t}$$
$$V(x(t+\Delta t) | F_t) = \frac{\sigma^2}{2a} (1 - e^{-2a \Delta t})$$
$$Cov\{x(t+\Delta t), y(t+\Delta t) | F_t \} = \frac{\sigma \nu \rho}{a + b} (1-e^{-(a+b)\Delta t})$$

Pour que le $((\widetilde{x}_i, \widetilde{y}_i)$ et $(x(i \Delta i), (y(i \Delta t))_i $ aient les même moment, la loi de  $((\widetilde{x}_i, \widetilde{y}_i)$  est donnée par:
$$\mathrm{P} \left( \widetilde{x}_{i+1} = \widetilde{x}_i + a \, \mathrm{d}x, \widetilde{y}_{i+1} = \widetilde{y}_i + b \, \mathrm{d}y |  \widetilde{x}_i, \widetilde{y}_i \right) = p^{a, b}( \widetilde{x}_i, \widetilde{y}_i)$$
où 
\begin{itemize}
\item $a, b \in \{-1, +1\}$
\item $p$ est donnée par
\end{itemize}

Le pricing se fait en deux temps:
\begin{itemize}
\item On diffuse le processus $(\widetilde{x}, \widetilde{y})$ dans l'arbre en prenant soin de calculer la probabilité de transition d'un état à un autre
\item On ``drawback'' dans l'arbre en partant de la date à laquelle on fait le payoff, et on discount
  \end{itemize}


Si nous implémentons l'abre de façon naîve, le nombre de noeuds augmente de façon exponentielle en fonction du nombre de pas de temps. En pratique ceci est problématique et conduit vite à une saturation de mémoire. Dans l'exemple simplifié ci-dessus nous traçons l'arbre de diffusion du premier facteur ($x(t)$). A chaque pas de temps le nombre de noeuds double, ie pour $n$ pas de temps, nous nous retrouvons avec $2^n$ noeuds pour un facteur, ou $4^n$ pour deux. 

Remarquer que $(x, y)_i$tilde est un processus markovien homogène à valeurs discrètes nous permet d'optimiser la simulation de l'arbre. En effet, il nous suffit de calculer la table de transition une fois au début du programme et de la réutiliser pour avancer/reculer dans le temps. 

\input{graph.tex}


Une autre améliroation possible est de trouver une formule analytique pour certain produits. En effet, si nous reprenons l'exemple d'un cancellable spread option 2Y10Y dont la maturité est dans 5 ans, nous devrions normalement construite l'arbre jusqu'en 2030 pour avoir le taux 10Y en 2020. Nous pouvons éviter celà en fournissant directement une formule exacte pour les zéro coupons.

$$ \int r \sim Normal$$
$$P(t, T) = \espr{ e^{\int r}} = exp  \left( \espr{ \int r} + \frac{ Var [ \int r ]  }{2} \right) $$

\subsubsection{ Paramètres constants}
<Calcul >
\subsubsection{ Paramètres dépendant du temps}
<Calcul>


On vérifie expérimentalement que le gain est significatif
<Cache grind > 

\subsubsection{Code python}


\IMG{img/slice.png}{Slice}{0.5}

Cependant, on ne peut ajouter un drift au noeud avec cette methode.

Paragraphe sur la taille des slice, ellipsoid
<example de Slice>


\begin{itemize}
\item Discrétisation
\item Construction de l'abre
\end{itemize}

\subsection{Formule analytique - Intégration}

Closed form des zero coupons

en pratique, gain en temps \\
< cachegrind results > \\

gain en precision \\
<Comparaison de slice entre cf et bf>


Amerlioration:
\begin{itemize}
\item Time dependant parameters
\end{itemize}

\subsection{Performance}
L'arbre est long mais beaucoup plus puissant
Imperfections de l'arbre:
\begin{itemize}
\item  bornee
\item  discretisation
\item  probabilite negative
\end{itemize}
Monte Carlo
Limitation
Closed Form

Le temps d'execution:
Arbre
Closed form

\newpage
\section{Application: calibration et pricing}
Le modèle à 2F permet de caputrer le hump de la courbe de rendement
Le nombre de paramètre est fini (5) => pas de overfitting


\subsection{Calibration}
Dans cette section on verra a quel point le modele peut fitter la realite.

\begin{itemize}
\item $h(t)$ pour reconstruire la yield curve $\sigma \rho \nu$ pour
\item  matcher la surface
\end{itemize}

\subsubsection{Calibration du drift}

$\Pi_j$ state price (arrow debrew) (paye 1 si le noeud $(t_n, j)$ est atteint.

$$D_j(h_n) := \frac{1}{1 + r(t_n)(t_{n+1} - t_n)} $$ Le discount factor
$$ \Pi_j(t_{n+1}) = \sum_j \Pi_j(t_n) p_{j, j'}(t_n) D_{j'}(h_n)$$
$$ \sum \Pi_j D_j(h_n) = P(0, t_{n+1}) $$

Developement de taylor => trouver $h_n$


\subsubsection{Methode de calibration de la surface - Méthode d'optimisation}

On calibre les caplets

Les caplets ne sont pas directement disponilbe sur les marche
On calibre les swaptions/caps

\begin{itemize}
\item Le probleme de calbration est un probleme d'optimisation Courbe
  de vol implicite :
\item minimisation de l'erreur L2
\end{itemize}
\IMG{img/capsurf.png}{Cap surface}{0.5}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
